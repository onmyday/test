(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{762:(e,r,t)=>{Promise.resolve().then(t.bind(t,4823))},4823:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>k});var a=t(2115),s=t(6046);let n="/auth",o={AUTHENTICATION:{PATH:n,LOGIN:{PATH:"".concat(n,"/login")},REGISTRATION:{PATH:"".concat(n,"/registration")}}};var c=t(5742),l=t(565);let i=()=>{localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken")},u=async()=>{let e=localStorage.getItem("refreshToken");if(!e)return null;let r=await fetch("/api/refresh-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:e})});if(!r.ok)return i(),null;{let e=await r.json();return localStorage.setItem("accessToken",e.accessToken),localStorage.setItem("refreshToken",e.refreshToken),e.accessToken}};var T=t(2818);let{useCheckRefQuery:I}=(0,c.xP)({reducerPath:"refApi",baseQuery:(()=>{let e=(0,l.cw)({baseUrl:T.env.NEXT_PUBLIC_API_URL,prepareHeaders:e=>{let r=localStorage.getItem("accessToken");return r&&e.set("Authorization","Bearer ".concat(r)),e}});return async(r,t,a)=>{var s;let n=await e(r,t,a);if(n.error&&(401===n.error.status||(null===(s=n.error)||void 0===s?void 0:s.status)===403)){let s=await u();s?("string"==typeof r&&(r={url:r,headers:new Headers}),r.headers||(r.headers=new Headers),r.headers.set("Authorization","Bearer ".concat(s)),n=await e(r,t,a)):i()}return n}})(),endpoints:e=>({checkRef:e.query({query:e=>"/api/links/checkRef?linkId=".concat(e)})})});var h=function(e){return e.ACTIVE="ACTIVE",e.PENDING="PENDING",e.DEACTIVE="DEACTIVE",e}({});let f=e=>{let r=(0,s.useRouter)(),{data:t,isLoading:n,error:c}=I(e);return(0,a.useEffect)(()=>{t&&t.status===h.ACTIVE&&r.push(o.AUTHENTICATION.REGISTRATION.PATH)},[t,r]),{data:t,isLoading:n,error:c}};function k(){f("123123")}}},e=>{var r=r=>e(e.s=r);e.O(0,[543,441,517,358],()=>r(762)),_N_E=e.O()}]);